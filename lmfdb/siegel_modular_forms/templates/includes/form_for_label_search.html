<script>
    function prepare_label_query() {

	var label_glob = document.getElementById( "label_glob").value.trim()
	var re = /^([a-zA-Z0-9\(\)_\*]+)\.([a-zA-Z0-9\(\)_\.\*]+)$/;
	m = label_glob.match( re);
//	alert( m);
	if ( m) {
	    a = m[1].replace(/\*/g, ".*")
	    b = m[2].replace(".", "\.").replace(/\*/g, ".*")
	    alert( a + "<-->" + b);
	    queryObj = { "collection" : { "$regex": a}, "name": { "$regex": b}};
	    document.getElementById("label_query").value = JSON.stringify( queryObj);
	    return true;
	}
	else {
	    alert( "Insert a glob of the form 'g1.g2', where 'g1' and 'g2' are sequences of\n\nletters, digits or the symbols '()_.' or '*'");
	    return false;
	}
	return false;
    }
</script>
<form action="/ModularForm/GSp/Q/search_results" method="get" onsubmit="return prepare_label_query()">
  <input type="hidden" id="label_query" name="query" /> 
  <table>
    <tr>
      <td>
	<label>label</label>
      </td>
      <td>
	<input type="text" id="label_glob" size=20 placeholder="SP4Z.26.Ups.1">
	<span class="formexample">e.g. SP4Z.26.Ups.1 or SP*.*.E or Kp.PY.*</span>
      </td>
      <td>
	<button type="submit" value="submit">Find</button>
      </td>
      </tr>
  </table>
</form>
