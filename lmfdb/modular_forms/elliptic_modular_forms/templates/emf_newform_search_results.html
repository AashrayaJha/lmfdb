{% extends 'homepage.html' %}

{% block content %}

<h2>Refine search </h2>

<form id="re-search" onsubmit="cleanSubmit(this.id)">
<input type="hidden" name="start" value="{{info.start}}"/>
<input type="hidden" name="count" value="{{info.count}}"/>

<table>
<td>{{ KNOWL('mf.elliptic.level', title='level')}}</td>
<td>{{ KNOWL('mf.elliptic.weight', title='weight') }}</td>
<td>{{ KNOWL('mf.elliptic.hecke-orbit', title='hecke orbit dimension') }}</td>
<td>{{ KNOWL('mf.elliptic.', title='coefficient field')}}</td>
</tr>

<tr>
<td><input type='text' name='level' placeholder='10' style="width: 100px" value="{{info.level}}"></td>
<td><input type='text' name='weight' placeholder='4' style="width: 100px" value="{{info.weight}}"></td>
<td><input type='text' name='dim' placeholder='1'  style="width: 100px" value="{{info.dim}}">
<td><input type='text' name='nf_label' placeholder='1.1.1.1'  style="width: 100px" value="{{info.nf_label}}">
</tr>

<tr style="height:50px">
<td class="button"><button type='submit' value='refine' style="width: 110px">Search again</button></td>
<td align=left colspan="7">
<input type="hidden" name="query" value="{{info.query}}"/>
Download all search results for&nbsp;
<button type="submit" name="download" value="gp">Pari/GP</button>&nbsp;
<button type="submit" name="download" value="sage">SageMath</button>&nbsp;
<button type="submit" name="download" value="magma">Magma</button>&nbsp;
</td>
</tr>

</table>
</form>

{% include 'matches.html' %}
{% if info.number %}

<table class="ntdata">
<tr>
    <th>{{ KNOWL('mf.elliptic.label', title='Label') }}</th>
    <th>{{ KNOWL('mf.elliptic.dimension_galois_orbit', title='Dimension') }}</th>
    <th>{{ KNOWL('mf.elliptic.coefficient_field', title='Coefficient Field') }}</th>
    <th>\(\operatorname{Tr}(a_2)\)</th>
    <th>\(\operatorname{Tr}(a_3)\)</th>
    <th>\(\operatorname{Tr}(a_5)\)</th>
    <th>\(\operatorname{Tr}(a_7)\)</th>
    <th>{{ KNOWL('mf.elliptic.q-expansion', title='$q$-expansion') }}</th>
</tr>
{% for mf in info.results: %}
<tr>
    <td> <a href="{{info.mf_url(mf.label)}}"> {{ mf.label }} </a> </td>
    <td> {{ mf.dim }} </td>
    <td>
        {% if mf.nf_label %}
        <a href="{{ info.nf_url(mf.nf_label) }}"> {{ info.nf_pretty(mf.nf_label) }} </a>
        {% else %}
        Not in LMFDB.
        {# TODO make it clear we have poly #}
        {% endif %}
        {# TODO do we want a knowl here ? #}
    </td>
    <td align="right">\({{ mf.trace_display[0] }}\)</td>
    <td align="right">\({{ mf.trace_display[1] }}\)</td>
    <td align="right">\({{ mf.trace_display[2] }}\)</td>
    <td align="right">\({{ mf.trace_display[3] }}\)</td>
    <td>
        {% if mf.qexp_display %}
        \({{ mf.qexp_display }}\)
        {% else %}
        -
        {% endif %}
    </td>
</tr>
{% endfor %}
</table>

{% include 'forward_back.html' %}
{% include 'download_search_results.html' %}
{% endif %}
{% include 'debug_info.html' %}

<!-- Debugging! -->
{% if DEBUG %}
<hr>
<div>
Info was: {{info}}
</div>
{% endif %}

{% endblock %}
