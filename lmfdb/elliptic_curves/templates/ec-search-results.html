{% extends 'homepage.html' %}

{% block content %}

{# {{ info.query }}  #}


<h2> Further refine search </h2>

<form id='re-search'>
<input type="hidden" name="start" value="{{info.start}}"/>
<table border="0" cellpadding="5">

<tr>
<td align=left>{{ KNOWL('ec.q.conductor', title='Conductor') }}</td>
<td align=left>{{ KNOWL('ec.q.j_invariant', title='j-invariant') }}</td>
<td align=left>{{ KNOWL('ec.complex_multiplication',title="CM") }} </td>
<td align=left>{{ KNOWL('ec.q.rank', title='Rank') }}</td>
<td align=left>{{ KNOWL('ec.q.torsion_order', title='Torsion order') }}</td>
<td align=left>{{ KNOWL('ec.q.torsion_subgroup', title='Torsion structure') }}</td>
<td align=left>{{ KNOWL('ec.q.analytic_sha_order', title='Analytic order of &#1064;') }}</td>
</tr>

<tr>
<td align=left><input type='text' name='conductor' size=10 value={{info.conductor}}></td>
<td align=left><input type='text' name='jinv'size=5 value={{info.jinv}}></td>
<td>         <select name='include_cm'>
{% if info.include_cm == "only" %}
           <option value="include">include</option>
           <option value="exclude">exclude</option>
           <option value="only" selected="yes">only</option>
{% else %}
{% if info.include_cm == "exclude" %}
           <option value="include">include</option>
           <option value="exclude" selected="yes">exclude</option>
           <option value="only">only</option>
{% else %}
           <option value="include" selected="yes">include</option>
           <option value="exclude">exclude</option>
           <option value="only">only</option>
{% endif %}
{% endif %}
         </select>
</td>
<td align=left><input type='text' name='rank'size=2 value={{info.rank}}></td>
<td align=left><input type='text' name='torsion' size=6 value={{info.torsion}}> </td>
<td align=left>
         <select name='torsion_structure'>
           {% if info.torsion_structure=="[]" %}
           <option value="[]" selected="yes">trivial</option>
           {% else %}
           <option value="[]">trivial</option>
           {% endif %}
           {% if info.torsion_structure=="[2]" %}
           <option value="[2]" selected="yes">$C_2$</option>
           {% else %}
           <option value="[2]">$C_2$</option>
           {% endif %}
           {% if info.torsion_structure=="[3]" %}
           <option value="[3]" selected="yes">$C_3$</option>
           {% else %}
           <option value="[3]">$C_3$</option>
           {% endif %}
           {% if info.torsion_structure=="[4]" %}
           <option value="[4]" selected="yes">$C_4$</option>
           {% else %}
           <option value="[4]">$C_4$</option>
           {% endif %}
           {% if info.torsion_structure=="[5]" %}
           <option value="[5]" selected="yes">$C_5$</option>
           {% else %}
           <option value="[5]">$C_5$</option>
           {% endif %}
           {% if info.torsion_structure=="[6]" %}
           <option value="[6]" selected="yes">$C_6$</option>
           {% else %}
           <option value="[6]">$C_6$</option>
           {% endif %}
           {% if info.torsion_structure=="[7]" %}
           <option value="[7]" selected="yes">$C_7$</option>
           {% else %}
           <option value="[7]">$C_7$</option>
           {% endif %}
           {% if info.torsion_structure=="[8]" %}
           <option value="[8]" selected="yes">$C_8$</option>
           {% else %}
           <option value="[8]">$C_8$</option>
           {% endif %}
           {% if info.torsion_structure=="[9]" %}
           <option value="[9]" selected="yes">$C_9$</option>
           {% else %}
           <option value="[9]">$C_9$</option>
           {% endif %}
           {% if info.torsion_structure=="[10]" %}
           <option value="[10]" selected="yes">$C_{10}$</option>
           {% else %}
           <option value="[10]">$C_{10}$</option>
           {% endif %}
           {% if info.torsion_structure=="[12]" %}
           <option value="[12]" selected="yes">$C_{12}$</option>
           {% else %}
           <option value="[12]">$C_{12}$</option>
           {% endif %}
           {% if info.torsion_structure=="[2,2]" %}
           <option value="[2,2]" selected="yes">$C_2\times C_2$</option>
           {% else %}
           <option value="[2,2]">$C_2\times C_2$</option>
           {% endif %}
           {% if info.torsion_structure=="[2,4]" %}
           <option value="[2,4]" selected="yes">$C_2\times C_4$</option>
           {% else %}
           <option value="[2,4]">$C_2\times C_4$</option>
           {% endif %}
           {% if info.torsion_structure=="[2,6]" %}
           <option value="[2,6]" selected="yes">$C_2\times C_6$</option>
           {% else %}
           <option value="[2,6]">$C_2\times C_6$</option>
           {% endif %}
           {% if info.torsion_structure=="[2,8]" %}
           <option value="[2,8]" selected="yes">$C_2\times C_8$</option>
           {% else %}
           <option value="[2,8]">$C_2\times C_8$</option>
           {% endif %}
         </select>
{#  <input type='text' name='torsion_structure' size=7
           value={{info.torsion_structure}}>
         #}
</td>
<td align=left><input type='text' name='sha' size=5 value={{info.sha}}> </td>
</tr>

<tr>
<td align=left>{{ KNOWL('ec.isogeny', title='isogeny degree') }}</td>
{% if info.galois_data_type=='new' %}
<td align=left>{{KNOWL('ec.maximal_galois_rep', title='maximal primes')}} 
{% else %}
<td align=left>{{KNOWL('ec.q.surjective_prime', title='surjective primes')}} 
{% endif %}
</td>
{% if info.galois_data_type=='new' %}
<td align=left colspan=2>{{KNOWL('ec.maximal_galois_rep', title='non-maximal primes')}} 
{% else %}
<td align=left colspan=2>{{KNOWL('ec.q.surjective_prime', title='non-surjective primes')}} 
{% endif %}
</td>
<td align=left>{{ KNOWL('ec.q.optimal', title='Optimal only') }}</td>
</tr>
<tr>
<td align=left><input type='text' name='isodeg' size=5 value={{info.isodeg}}> </td>
<td align=left>
   <input type='text' name='surj_primes' size=10 value={{info.surj_primes}}>
</td>
<td align=left colspan=2>
  <select name='surj_quantifier'>
{% if info.surj_quantifier=='exactly' %}
  <option value='include'>include</option>
  <option selected="yes" value='exactly'>exactly</option>
{% else %}
  <option value='include'>include</option>
  <option value='exactly'>exactly</option>
{% endif %}
  </select>
<input type='text' name='nonsurj_primes' size=10  value={{info.nonsurj_primes}}>
</td>
<td align=left>
<select name='optimal'>
{% if info.optimal=='on' %}
  <option value="">No</option>
  <option selected="yes" value="on">Yes</option>
{% else %}
  <option value="">No</option>
  <option value="on">Yes</option>
{% endif %}
</select>
</td>
</tr>

<tr>
<td align=left colspan=2>Maximum number of curves to display
</td>
<td align=left><input type='text' name='count' value={{info.count}} size=10>
</td>
<td>&nbsp;
</td>
<td colspan=3>
<button type='submit' value='refine'>Update search</button>
</td> </tr>
</table>
</form>

{% if info.err is defined %}

<h2>Error</h2>
<div>
  {{ info.err|safe }}
  <p>
  Either modify your search above or go <input type=button value="Back" onClick="history.go(-1)">
</div>

{% else %}

<style type="text/css">
table td.center {
  text-align: center;
}
table td.params {
  text-align: left;
  font-family: monospace;
}

</style>

{% if info.number %}

<h2> Results ({{info.report}})
{% if info.start > 0 %}
<a href="#" class="navlink"
   onclick="decrease_start_by_count_and_submit_form('re-search');return
            false">Previous</A>
{% endif %}
{% if info.more > 0 %}
<a href="#" class="navlink" onclick="increase_start_by_count_and_submit_form('re-search');return false">Next</A>
{% endif %}
</h2>
<table>
<tr>
  <th class="center">{{ KNOWL('ec.q.lmfdb_label', title='LMFDB label')}}</th>
  <th class="center">{{ KNOWL('ec.q.cremona_label', title='Cremona label')}}</th>
  <th class="center">{{ KNOWL('ec.isogeny_class', title='Isogeny class') }}</th>
  <th class="center">{{ KNOWL('ec.weierstrass_coeffs',  title='Weierstrass Coefficients') }}</th>
  <th class="center">{{ KNOWL('ec.q.rank', title='Rank') }}</th>
  <th class="center">{{ KNOWL('ec.q.torsion_order', title='Torsion order') }}</th>
{% if info.surj_primes or info.nonsurj_primes  %}
{% if info.galois_data_type=='new' %}
  <th class="center">{{KNOWL('ec.maximal_galois_rep', title='Non-maximal primes')}}</th>
{% else %}
  <th class="center">{{KNOWL('ec.q.non-surjective_prime', title='Non-surjective primes')}}</th>
{% endif %}
{% endif %}
</tr>
{% for curve in info.curves: %}
<tr>
<td class="center"><a href="{{info.curve_url(curve)}}">{{curve.lmfdb_label}}</a></td>
<td class="center">{{curve.label}}</td>
<td class="center"><a href="{{info.iso_url(curve)}}">{{curve.lmfdb_iso}}</a></td>
<td class="params">{{info.format_ainvs(curve.ainvs)}}</td>
<td class="center">{{curve.rank}}</td>
<td class="center">{{curve.torsion}}</td>
{% if info.surj_primes or info.nonsurj_primes %}
{% if info.galois_data_type=='new' %}
<td class="center">{{curve['non-maximal_primes']}}</td>
{% else %}
<td class="center">{{curve['non-surjective_primes']}}</td>
{% endif %}
{% endif %}
</tr>
{% endfor %}
</table>

<hr>
{% if info.start > 0 %}
<a href="#" class="navlink"
   onclick="decrease_start_by_count_and_submit_form('re-search');return
            false">Previous</A>
{% endif %}
{% if info.more > 0 %}
<a href="#" class="navlink" onclick="increase_start_by_count_and_submit_form('re-search');return false">Next</A>
{% endif %}

<br>
<br>
{% if info.number < 100001 %}

<form>
Download all search results for
<input type="submit" name="Submit" value="gp">
<input type="submit" name="Submit" value="sage">
<input type="submit" name="Submit" value="magma">
<input type="hidden" name="download" value="1"/>
<input type="hidden" name="query" value="{{info.query}}"/>
</form>
{% else %}
There are too many curves in the search results for downloading.
{% endif %} {# provide download links? #}


{% else %}
<h2> No matches</h2>
{% endif %}

{% endif %}




{#
Query was: {{info.query}}
#}



{% endblock %}
